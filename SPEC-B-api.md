# Overview

This document defines the HTTP API Contract exposed by the Experience API for managing a shopping cart.

## Base URL

```bash
/api/cart
```

All endpoints communicate using JSON

## Create Cart

Create a new cart and return the cart object

##### Request

```bash
POST /api/cart
```

No Request Body is required

##### Response (201 Created)

```json
{
  "cartId": "random-cart-id-1234567890"
  "items": [],
  "totals":{
    "subtotal": 0.00,
    "itemCount": 0
  }
}
```

## Get Cart

Fetches the current state of the requested cart.

##### Request

```bash
GET /api/cart/{cartId}
```

##### Response (200 OK)

```json
{
  "cartId": "random-cart-id-1234567890",
  "items": [
    {
      "itemId": "random_item_id_123",
      "sku": "ITEM_123",
      "quantity": 2,
      "unitPrice": 10,
      "totalPrice": 20
    }
  ],
  "totals": {
    "subtotal": 20,
    "itemCount": 2
  }
}
```

## Add Item to Cart

Add a new item in the cart

##### Request

```bash
POST /api/cart/{cartId}/items
```

```json
{
  "sku": "ITEM_123",
  "quantity": 2
}
```

##### Response (202 OK)

Returns the updated cart object as done for GetCart response

## Update Item Quantity in Cart

Updates the quantity of an item in the cart

```bash
PUT /api/cart/{cartId}/items/{itemId}
```

```json
{
  "quantity": 3
}
```

If the quantity is set to 0, remove the item from the cart

##### Response (200 OK)

Returns the updated cart object as done for GetCart response

## Remove item from Cart

Removes the item from the cart

```bash
DELETE /api/cart/{cartId}/items/{itemId}
```

##### Response (200 OK)

Returns the updated cart object as done for GetCart response

# Error Responses

### Cart not found or expired

##### Response - 404 Not Found

```json
{
  "error": "CART_NOT_FOUND",
  "message": "Cart not found or expired"
}
```

### Invalid Quantity

##### Response - 400 Bad Request

```json
{
  "error": "INVALID_QUANTITY",
  "message": "Invalid quantity. It must be greater than zero"
}
```

### Item Not Found

##### Response - 404 Not Found

```json
{
  "error": "ITEM_NOT_FOUND",
  "message": "Item does not exists in the cart"
}
```

# API Security

All API requests are protected using a simple API key mechanism. Clients must use include the API key in the header.
HTTP Requests missing the API key would be rejected with a 401 Unauthorized response.

# Assumptions

- Cart expiry cannot be configured by API. It is handled internally by the SalesforceCartClient
- Taxes, Promotions and shipping are out of scope
- itemId is generated by the system and is unique within a cart.
- Authentication and Authorization are not covered as it is assumed to be used by guest users.
